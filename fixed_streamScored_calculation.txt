// Original calculation
val limit = this.limit match {
  case Some(l) => math.min(l, total)
  case None => total
}
Task.pure(fetchAllPages(limit, offset))

// Fixed calculation
val endOffset = this.limit match {
  case Some(l) => offset + math.min(l, total - offset)
  case None => total
}
Task.pure(fetchAllPages(endOffset, offset))